services:
  # Main MEDUSA service - scan local project
  medusa:
    build:
      context: .
      dockerfile: Dockerfile
    image: medusa-security:0.7.0.0
    container_name: medusa-scanner
    volumes:
      - .:/workspace:ro  # Mount current directory as read-only
    command: scan /workspace

  # Development service - interactive shell
  medusa-dev:
    build:
      context: .
      dockerfile: Dockerfile
    image: medusa-security:0.7.0.0
    container_name: medusa-dev
    volumes:
      - .:/workspace
    entrypoint: /bin/bash
    stdin_open: true
    tty: true

  # Test service - runs tests in container
  medusa-test:
    build:
      context: .
      dockerfile: Dockerfile.test
    image: medusa-test:0.7.0.0
    container_name: medusa-test
    volumes:
      - .:/workspace
    command: pytest tests/ -v
